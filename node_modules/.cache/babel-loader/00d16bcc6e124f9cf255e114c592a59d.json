{"ast":null,"code":"var _jsxFileName = \"/Users/heytea/lbt-music/src/components/playbar/11.js\";\nimport React, { Component } from \"react\";\nimport '../../statics/style/audioqq.css';\nimport store from \"../../store\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Audio extends Component {\n  constructor(props) {\n    super(props);\n\n    this.canplay = () => {\n      this.audio.current.oncanplay = () => {\n        var allTime = (Math.floor(this.audio.current.duration / 60) + \"\").padStart(2, \"0\") + \":\" + (Math.floor(this.audio.current.duration % 60) + \"\").padStart(2, \"0\");\n        const action = {\n          type: 'change_allTime',\n          value: allTime\n        };\n        store.dispatch(action);\n      };\n    };\n\n    this.timeUpdate = () => {\n      this.audio.current.ontimeupdate = () => {\n        // console.log(this.audio.current.currentTime)\n        // console.log(this.audio.current.duration)\n        var currentTime = (Math.floor(this.audio.current.currentTime / 60) + \"\").padStart(2, \"0\") + \":\" + (Math.floor(this.audio.current.currentTime % 60) + \"\").padStart(2, \"0\");\n        const action = {\n          type: 'change_current',\n          value: currentTime\n        };\n        store.dispatch(action);\n        this.inner.current.style.width = this.audio.current.currentTime / this.audio.current.duration * 100 + \"%\";\n      };\n    };\n\n    this.audioPlay = () => {\n      this.audio.current.play();\n    };\n\n    this.audioStop = () => {\n      this.audio.current.pause();\n    };\n\n    this.audioX = e => {\n      console.log('鼠标到可视区左侧的距离', e.targetTouches[0].clientX);\n      var outerWidth = this.outer.current.offsetWidth; //父元素宽\n\n      var innerWidth = e.targetTouches[0].clientX; //鼠标到左侧的距离\n\n      if (innerWidth > outerWidth || innerWidth < 0) {\n        return;\n      }\n\n      this.inner.current.style.width = innerWidth + \"px\";\n      this.audio.current.currentTime = innerWidth / outerWidth * this.audio.current.duration;\n    };\n\n    this.handleAudio = () => {\n      let audio = this.audio.current; // timeupdate,播放位置改变时触发\n\n      audio.addEventListener(\"timeupdate\", () => {\n        console.log(\"播放位置改变\");\n      }); // canplay,表示音频可以播放了，准备就绪\n\n      audio.addEventListener(\"canplay\", () => {\n        console.log(\"可以播放了\");\n      }); // progress，音频在加载或缓冲\n\n      audio.addEventListener(\"progress\", () => {\n        console.log(\"音频在加载或缓冲\");\n      }); // waiting,需要缓冲下一帧而停止播放时触发\n\n      audio.addEventListener(\"waiting\", () => {\n        console.log(\"需要缓冲下一帧\");\n      }); // playing,音频或视频已开始播放时触发\n\n      audio.addEventListener(\"playing\", () => {\n        console.log(\"开始播放\");\n      }); // pause,音频或视频文件暂停时触发\n\n      audio.addEventListener(\"pause\", () => {\n        console.log(\"已经暂停\");\n      });\n    };\n\n    this.state = store.getState();\n    this.outer = /*#__PURE__*/React.createRef(); //进度条外框\n\n    this.inner = /*#__PURE__*/React.createRef(); //进度条内核\n\n    this.audio = /*#__PURE__*/React.createRef();\n  }\n\n  componentDidMount() {\n    // console.log(this.audio);\n    this.canplay();\n    this.timeUpdate();\n    this.handleAudio();\n  } //在音频可以播放时就显示总时长\n\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"\\u5F53\\u524D\\u65F6\\u95F4\\uFF1A\", this.state.current]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"\\u603B\\u65F6\\u95F4\\uFF1A\", this.state.allTime]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"outer\",\n        ref: this.outer,\n        onTouchMove: e => this.audioX(e),\n        onTouchStart: e => this.audioX(e),\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inner\",\n          ref: this.inner,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"innerBtn\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n        ref: this.audio,\n        src: \"http://m7.music.126.net/20210324111803/24a6306b8de55d5fd9014726f3b3015f/ymusic/0fd6/4f65/43ed/a8772889f38dfcb91c04da915b301617.mp3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => this.audioPlay(),\n        children: \"\\u64AD\\u653E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => this.audioStop(),\n        children: \"\\u6682\\u505C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default Audio;","map":{"version":3,"sources":["/Users/heytea/lbt-music/src/components/playbar/11.js"],"names":["React","Component","store","Audio","constructor","props","canplay","audio","current","oncanplay","allTime","Math","floor","duration","padStart","action","type","value","dispatch","timeUpdate","ontimeupdate","currentTime","inner","style","width","audioPlay","play","audioStop","pause","audioX","e","console","log","targetTouches","clientX","outerWidth","outer","offsetWidth","innerWidth","handleAudio","addEventListener","state","getState","createRef","componentDidMount","render"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\nimport '../../statics/style/audioqq.css';\nimport store from \"../../store\";\n\nclass Audio extends Component {\n    constructor(props) {\n        super(props);\n        this.state = store.getState()\n\n        this.outer = React.createRef(); //进度条外框\n        this.inner = React.createRef(); //进度条内核\n        this.audio = React.createRef();\n    }\n\n    componentDidMount() {\n        // console.log(this.audio);\n        this.canplay();\n        this.timeUpdate();\n        this.handleAudio();\n\n\n    }\n\n    //在音频可以播放时就显示总时长\n    canplay = () => {\n        this.audio.current.oncanplay = () => {\n            var allTime =\n                (Math.floor(this.audio.current.duration / 60) + \"\").padStart(2, \"0\") +\n                \":\" +\n                (Math.floor(this.audio.current.duration % 60) + \"\").padStart(2, \"0\");\n            const action = {\n                type: 'change_allTime',\n                value:  allTime\n            }\n            store.dispatch(action)\n        };\n    }\n\n    //在音频播放时当前时间也跟着变化\n    timeUpdate = () => {\n        this.audio.current.ontimeupdate = () => {\n            // console.log(this.audio.current.currentTime)\n            // console.log(this.audio.current.duration)\n            var currentTime =\n                (Math.floor(this.audio.current.currentTime / 60) + \"\").padStart(2, \"0\")\n                + \":\" +\n                (Math.floor(this.audio.current.currentTime % 60) + \"\").padStart(2, \"0\");\n\n            const action = {\n                type: 'change_current',\n                value:  currentTime\n            }\n            store.dispatch(action)\n\n            this.inner.current.style.width =\n                (this.audio.current.currentTime / this.audio.current.duration) * 100 + \"%\";\n        };\n    }\n\n    //播放开始\n    audioPlay = () => {\n        this.audio.current.play();\n    }\n\n    //播放暂停\n    audioStop = () => {\n        this.audio.current.pause();\n    }\n\n\n    //设置播放进度\n    audioX = (e) => {\n        console.log('鼠标到可视区左侧的距离', e.targetTouches[0].clientX);\n        var outerWidth = this.outer.current.offsetWidth; //父元素宽\n        var innerWidth = e.targetTouches[0].clientX //鼠标到左侧的距离\n        if (innerWidth > outerWidth || innerWidth < 0) {\n            return;\n        }\n        this.inner.current.style.width = innerWidth + \"px\";\n        this.audio.current.currentTime =\n            (innerWidth / outerWidth) * this.audio.current.duration;\n    }\n\n    handleAudio = () => {\n        let audio = this.audio.current;\n        // timeupdate,播放位置改变时触发\n        audio.addEventListener(\"timeupdate\", () => {\n            console.log(\"播放位置改变\");\n        });\n        // canplay,表示音频可以播放了，准备就绪\n        audio.addEventListener(\"canplay\", () => {\n            console.log(\"可以播放了\");\n        });\n        // progress，音频在加载或缓冲\n        audio.addEventListener(\"progress\", () => {\n            console.log(\"音频在加载或缓冲\");\n        });\n        // waiting,需要缓冲下一帧而停止播放时触发\n        audio.addEventListener(\"waiting\", () => {\n            console.log(\"需要缓冲下一帧\");\n        });\n        // playing,音频或视频已开始播放时触发\n        audio.addEventListener(\"playing\", () => {\n            console.log(\"开始播放\");\n        });\n        // pause,音频或视频文件暂停时触发\n        audio.addEventListener(\"pause\", () => {\n            console.log(\"已经暂停\");\n        });\n    }\n\n    render() {\n        return (\n            <div>\n                <h1>当前时间：{this.state.current}</h1>\n                <h1>总时间：{this.state.allTime}</h1>\n                <div\n                    className=\"outer\"\n                    ref={this.outer}\n                    onTouchMove={e => this.audioX(e)}\n                    onTouchStart={e => this.audioX(e)}\n                >\n                    <div className=\"inner\" ref={this.inner}>\n                        <div className=\"innerBtn\"></div>\n                    </div>\n                </div>\n                <br/>\n                <br/>\n                <br/>\n                <audio ref={this.audio} src=\"http://m7.music.126.net/20210324111803/24a6306b8de55d5fd9014726f3b3015f/ymusic/0fd6/4f65/43ed/a8772889f38dfcb91c04da915b301617.mp3\">\n\n                </audio>\n                <button onClick={() => this.audioPlay()}>播放</button>\n                <button onClick={() => this.audioStop()}>暂停</button>\n            </div>\n        );\n    }\n}\n\nexport default Audio;"]},"metadata":{},"sourceType":"module"}