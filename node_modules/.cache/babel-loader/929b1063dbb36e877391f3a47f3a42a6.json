{"ast":null,"code":"var _jsxFileName = \"/Users/heytea/react-music-player-lbt/src/components/audio/index.js\";\nimport React, { Component } from \"react\";\nimport '../../statics/style/audio.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Audio extends Component {\n  constructor(props) {\n    super(props);\n\n    this.formatTime = value => {\n      const minute = (Math.floor(value / 60) + '').padStart(2, '0');\n      const second = (Math.floor(value % 60) + '').padStart(2, '0');\n      return `${minute}:${second}`;\n    };\n\n    this.canplay = () => {\n      console.log('lbtlbtl', this.audio.current.url);\n\n      this.audio.current.oncanplay = () => {\n        const totalTime = this.formatTime(this.audio.current.duration);\n        this.setState({\n          totalTime\n        });\n      };\n    };\n\n    this.timeUpdate = () => {\n      this.audio.current.ontimeupdate = () => {\n        if (!this.audio.current.currentTime) {\n          return;\n        }\n\n        const currentTime = this.formatTime(this.audio.current.currentTime);\n        this.setState({\n          currentTime\n        });\n        this.inside.current.style.width = this.audio.current.currentTime / this.audio.current.duration * 100 + \"%\";\n      };\n    };\n\n    this.onended = () => {\n      this.audio.current.onended = () => {\n        this.setState({\n          isPlay: false\n        });\n      };\n    };\n\n    this.audioPlay = () => {\n      this.setState({\n        isPlay: true\n      });\n      this.audio.current.play();\n    };\n\n    this.audioStop = () => {\n      this.setState({\n        isPlay: false\n      });\n      this.audio.current.pause();\n    };\n\n    this.onProgressChange = e => {\n      const outsideWidth = this.outside.current.offsetWidth;\n      const insideWidth = e.targetTouches[0].clientX - this.outside.current.getBoundingClientRect().left;\n      console.log('lbt onProgressChange', e, insideWidth, outsideWidth);\n\n      if (insideWidth > outsideWidth || insideWidth < 0) {\n        return;\n      }\n\n      this.inside.current.style.width = insideWidth + \"px\";\n      this.audio.current.currentTime = insideWidth / outsideWidth * this.audio.current.duration;\n    };\n\n    this.state = {\n      // url: this.props.audioUrl,\n      currentTime: \"00:00\",\n      totalTime: \"00:00\",\n      isPlay: false\n    };\n    this.outside = /*#__PURE__*/React.createRef();\n    this.inside = /*#__PURE__*/React.createRef();\n    this.audio = /*#__PURE__*/React.createRef();\n  }\n\n  componentDidMount() {\n    this.canplay();\n    this.timeUpdate();\n    this.onended();\n  } // shouldComponentUpdate(nextProps, nextState, nextContext) {\n  //     console.log('nextProps', nextProps)\n  //\n  // }\n\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"audio\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"audio-img\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          className: this.state.isPlay ? 'img-play' : 'img-paused',\n          src: this.props.imageUrl\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"audio-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: this.props.artistName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: this.props.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"audio-progress\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: this.state.currentTime\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"audio-outside\",\n          ref: this.outside // onMouseMove={(e)=> this.onProgressChange(e)}\n          // onMouseDown={(e)=> this.onProgressChange(e)}\n          ,\n          onTouchMove: e => this.onProgressChange(e),\n          onTouchStart: e => this.onProgressChange(e),\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"audio-inside\",\n            ref: this.inside,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"audio-inside-btn\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: this.state.totalTime\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n          ref: this.audio // src={this.state.url}\n          ,\n          src: (console.log('lbtlbtl', this.audio.current.url), `https://music.163.com/song/media/outer/url?id=${this.props.id}.mp3`)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"audio-btn\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"iconfont icon-prev\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"audio-playOrPauseBtn\",\n            children: !this.state.isPlay ? /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"iconfont icon-bofang\",\n              onClick: this.audioPlay\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 35\n            }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"iconfont icon-zanting\",\n              onClick: this.audioStop\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 35\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"iconfont icon-next\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"audio-lyrics\",\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"iconfont icon-lyrics\",\n          onClick: this.onShowLyricsClick\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default Audio;","map":{"version":3,"sources":["/Users/heytea/react-music-player-lbt/src/components/audio/index.js"],"names":["React","Component","Audio","constructor","props","formatTime","value","minute","Math","floor","padStart","second","canplay","console","log","audio","current","url","oncanplay","totalTime","duration","setState","timeUpdate","ontimeupdate","currentTime","inside","style","width","onended","isPlay","audioPlay","play","audioStop","pause","onProgressChange","e","outsideWidth","outside","offsetWidth","insideWidth","targetTouches","clientX","getBoundingClientRect","left","state","createRef","componentDidMount","render","imageUrl","artistName","name","id","onShowLyricsClick"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\nimport '../../statics/style/audio.css'\n\nclass Audio extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            // url: this.props.audioUrl,\n            currentTime: \"00:00\",\n            totalTime: \"00:00\",\n            isPlay: false\n        };\n        this.outside = React.createRef();\n        this.inside = React.createRef();\n        this.audio = React.createRef();\n    }\n\n    componentDidMount() {\n        this.canplay();\n        this.timeUpdate();\n        this.onended()\n    }\n\n    // shouldComponentUpdate(nextProps, nextState, nextContext) {\n    //     console.log('nextProps', nextProps)\n    //\n    // }\n\n    formatTime = (value) => {\n        const minute = (Math.floor(value / 60) + '').padStart(2, '0')\n        const second = (Math.floor(value % 60) + '').padStart(2, '0')\n        return `${minute}:${second}`\n    }\n\n    canplay = () => {\n        console.log('lbtlbtl',this.audio.current.url)\n        this.audio.current.oncanplay = () => {\n            const totalTime = this.formatTime(this.audio.current.duration)\n            this.setState({\n                totalTime\n            })\n        }\n    }\n\n    timeUpdate = () => {\n        this.audio.current.ontimeupdate = () => {\n            if(!this.audio.current.currentTime){return}\n            const currentTime = this.formatTime(this.audio.current.currentTime)\n            this.setState({\n                currentTime\n            })\n            this.inside.current.style.width =\n                (this.audio.current.currentTime / this.audio.current.duration) * 100 + \"%\";\n        }\n    }\n\n    onended = () => {\n        this.audio.current.onended = () => {\n            this.setState({\n                isPlay: false\n            })\n        }\n    }\n\n    audioPlay = () => {\n        this.setState({\n            isPlay: true\n        })\n        this.audio.current.play();\n    }\n\n    audioStop = () => {\n        this.setState({\n            isPlay: false\n        })\n        this.audio.current.pause();\n    }\n\n    onProgressChange = (e) => {\n        const outsideWidth = this.outside.current.offsetWidth\n        const insideWidth = e.targetTouches[0].clientX - this.outside.current.getBoundingClientRect().left\n        console.log('lbt onProgressChange',e, insideWidth, outsideWidth)\n        if (insideWidth > outsideWidth || insideWidth < 0){return}\n        this.inside.current.style.width = insideWidth + \"px\"\n        this.audio.current.currentTime = (insideWidth / outsideWidth) * this.audio.current.duration\n    }\n\n    render() {\n        return (\n            <div className=\"audio\">\n                <div className=\"audio-img\">\n                    <img\n                        className={this.state.isPlay ? 'img-play' : 'img-paused'}\n                        src={this.props.imageUrl}\n                    />\n                </div>\n                <div className=\"audio-info\">\n                    <span>{this.props.artistName}</span>\n                    <span>{this.props.name}</span>\n                </div>\n                <div className=\"audio-progress\">\n                    <span>{this.state.currentTime}</span>\n                    <div\n                        className=\"audio-outside\"\n                        ref={this.outside}\n                        // onMouseMove={(e)=> this.onProgressChange(e)}\n                        // onMouseDown={(e)=> this.onProgressChange(e)}\n                        onTouchMove={(e) => this.onProgressChange(e)}\n                        onTouchStart={(e) => this.onProgressChange(e)}\n                    >\n                        <div\n                            className=\"audio-inside\"\n                            ref={this.inside}\n                        >\n                            <div className=\"audio-inside-btn\"></div>\n                        </div>\n                    </div>\n                    <span>{this.state.totalTime}</span>\n                    <audio\n                        ref={this.audio}\n                        // src={this.state.url}\n                        src={(console.log('lbtlbtl',this.audio.current.url), `https://music.163.com/song/media/outer/url?id=${this.props.id}.mp3`)}\n                    ></audio>\n                    <div className=\"audio-btn\">\n                        <i className=\"iconfont icon-prev\"></i>\n                        <div className=\"audio-playOrPauseBtn\">\n                            {!this.state.isPlay\n                                ? <i\n                                    className=\"iconfont icon-bofang\"\n                                    onClick={this.audioPlay}\n                                ></i>\n                                : <i\n                                    className=\"iconfont icon-zanting\"\n                                    onClick={this.audioStop}\n                                ></i>\n                            }\n                        </div>\n                        <i className=\"iconfont icon-next\"></i>\n                    </div>\n                </div>\n                <div className=\"audio-lyrics\">\n                    <i\n                        className=\"iconfont icon-lyrics\"\n                        onClick={this.onShowLyricsClick}\n                    ></i>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default Audio;\n"]},"metadata":{},"sourceType":"module"}